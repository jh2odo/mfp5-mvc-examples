function formatoUrl(url) {
    var $texto = url;
    $texto = $texto.toLowerCase();
    $texto = $texto.replace(/^\s*|\s*$/g, "");
    while ($texto.toString().indexOf("-") != -1) {
        $texto = $texto.toString().replace("-", "_");
    }
    while ($texto.toString().indexOf(" ") != -1) {
        $texto = $texto.toString().replace(" ", "-");
    }
    while ($texto.toString().indexOf("á") != -1) {
        $texto = $texto.toString().replace("á", "a");
    }
    while ($texto.toString().indexOf("é") != -1) {
        $texto = $texto.toString().replace("é", "e");
    }
    while ($texto.toString().indexOf("í") != -1) {
        $texto = $texto.toString().replace("í", "i");
    }
    while ($texto.toString().indexOf("ó") != -1) {
        $texto = $texto.toString().replace("ó", "o");
    }
    while ($texto.toString().indexOf("ú") != -1) {
        $texto = $texto.toString().replace("ú", "u");
    }
    while ($texto.toString().indexOf("ñ") != -1) {
        $texto = $texto.toString().replace("ñ", "n");
    }
    return $texto;
}
function cargarPagina(objeto) {
    var ruta = $(objeto).attr("href");
    ruta = ruta.toString().replace("noticias", "noticias/lector");
    var posicion = '#diario-' + $(objeto).attr("title");
    $.ajax({
        type: 'GET',
        dataType: 'html',
        url: ruta.toString(),
        cache: false,
        error: function (xhr, desc, exceptionobj) {
            alert("ERROR: " + xhr.status + " - " + xhr.statusText + "\nComuniquenoslo si el fallo continua. Gracias.");
        },
        success: function (html) {
            $(posicion).html(html);
        }
    });
}
$(document).ready(function () {
    $(this).bind("ajaxStart", function () {
        $(this).scrollTop(100);
    });
    $("#cargando").bind("ajaxSend", function () {
        $(this).show();
    }).bind("ajaxComplete", function () {
        $(this).hide();
    });
    $(".ui-tabs-panel").bind("ajaxSend", function () {
        $(this).css({'opacity': '0.8', 'background-color': '#D1DEE9'});
    }).bind("ajaxComplete", function () {
        $(this).css({'opacity': '1', 'background-color': '#f7faef'});
    });
    $(".ui-tabs-nav").bind('tabsload', function (e, ui) {
        var $texto = $(ui.tab).text();
        $texto = formatoUrl($texto);
        $texto = $("#ruta a:eq(1)").attr("href") + $texto + "/";
        /* _gaq.push(['_trackPageview', '/' + $texto]);*/
    });
    $(".ui-tabs-nav").bind('tabsselect', function (e, ui) {
        var $href = $.data(ui.tab, 'load.tabs');
        var $actualizado = true;
        if ($href) {
            $actualizado = $href.toString().indexOf("noticias/lector");
        }
        if ($href && ($actualizado == -1)) {
            $href = $href.toString().replace("noticias", "noticias/lector");
            var obj = $(ui.index);
            $("#diarios > ul").tabs("url", obj["0"], $href.toString());
        }
        $(".noticias_informacion").hide();
    });
    $(".ui-tabs-nav").bind('tabsshow', function (e, ui) {
        var href = $(ui.tab).attr("href");
        if (href.toString().indexOf("#diario-0") == -1) {
            var $texto = $(ui.tab).text();
            $texto = formatoUrl($texto);
            $texto = $("#ruta a:eq(1)").attr("href") + $texto + "/";
            var $total = $("#ruta a").length;
            if ($total == 3) {
                $("#ruta a:last-child").attr("href", $texto);
                $("#ruta a:last-child").text($(ui.tab).text());
                $("#ruta a:last-child").attr("title", $(ui.tab).text());
            } else {
                $("#ruta").append(" &gt; <a href=\"" + $texto + "\" title=\"" + $(ui.tab).text() + "\">" + $(ui.tab).text() + "</a>");
            }
        } else {
            $("#ruta").replaceWith("<h2 id=\"ruta\" class=\"titulo\"><a href=\"" + $("#ruta a:eq(0)").attr("href") + "\" title=\"" + $("#ruta a:eq(0)").attr("title") + "\">" + $("#ruta a:eq(0)").text() + "</a> &gt; <a href=\"" + $("#ruta a:eq(1)").attr("href") + "\" title=\"" + $("#ruta a:eq(1)").attr("title") + "\">" + $("#ruta a:eq(1)").text() + "</a></h2>");
        }
        $(".noticias_informacion").show();
    });
});